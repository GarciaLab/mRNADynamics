ddH2OPrefix = {'2022-04-19-ddH2O_25C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-ddH2O_25C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-ddH2O_25C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-19-ddH2O_22_5C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-ddH2O_22_5C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-ddH2O_22_5C_PetriWithGlueNoEmbryos_50uW_Dish1'};

Temperatures = [17.5, 17.5, 17.5, 17.5, 17.5, 17.5, 20, 20, 20, 20, 20, 20,...
    22.5, 22.5, 22.5, 22.5, 22.5, 22.5,...
    25, 25, 25, 25, 25, 25,27.5, 27.5, 27.5, 27.5, 27.5, 27.5,...
    ];
Dilutions = [1000, 1000, 1000, 2000, 2000, 2000, 1000, 1000, 1000, 2000, 2000, 2000,...
    1000, 1000, 1000, 2000, 2000, 2000, 1000, 1000, 1000, 2000, 2000, 2000,...
    1000, 1000, 1000, 2000, 2000, 2000];
Powers = [25, 35, 50, 25, 35, 50, 25, 35, 50, 25, 35, 50,...
    25, 35, 50, 25, 35, 50, 25, 35, 50, 25, 35, 50,...
    25, 35, 50, 25, 35, 50];

Prefixes = {'2022-04-16-EGFP_1_1000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_25uW_Dish1',...
'2022-04-16-EGFP_1_1000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_35uW_Dish1',...
'2022-04-16-EGFP_1_1000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_50uW_Dish1',...
'2022-04-16-EGFP_1_2000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_25uW_Dish1',...
'2022-04-16-EGFP_1_2000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_35uW_Dish1',...
'2022-04-16-EGFP_1_2000Dilution_17_5C_PetriWithGlueWithOutsideGreaseNoEmbryos_50uW_Dish1',...
'2022-04-17-EGFP_1_1000Dilution_20C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-17-EGFP_1_1000Dilution_20C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-17-EGFP_1_1000Dilution_20C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-17-EGFP_1_2000Dilution_20C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-17-EGFP_1_2000Dilution_20C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-17-EGFP_1_2000Dilution_20C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_22_5C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_22_5C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_22_5C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_22_5C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_22_5C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_22_5C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_25C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_25C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-EGFP_1_1000Dilution_25C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_25C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_25C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-19-EGFP_1_2000Dilution_25C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-18-EGFP_1_1000Dilution_27_5C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-18-EGFP_1_1000Dilution_27_5C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-18-EGFP_1_1000Dilution_27_5C_PetriWithGlueNoEmbryos_50uW_Dish1',...
'2022-04-18-EGFP_1_2000Dilution_27_5C_PetriWithGlueNoEmbryos_25uW_Dish1',...
'2022-04-18-EGFP_1_2000Dilution_27_5C_PetriWithGlueNoEmbryos_35uW_Dish1',...
'2022-04-18-EGFP_1_2000Dilution_27_5C_PetriWithGlueNoEmbryos_50uW_Dish1',...
};
%%
AllTIFStacks = {};
AllMaxTIFs = {};
MeanValues = zeros(30, 3);
for i = 1:length(Prefixes)
    disp(['i = ', num2str(i)])
    Prefix = Prefixes{i};
    rootFolder = '';
  [rawDataPath, ProcPath, DropboxFolder, ~, PreProcPath, rawDataFolder, Prefix, ExperimentType, Channel1, Channel2, ~,...
      Channel3] = readMovieDatabase(Prefix,'rootFolder', rootFolder);
  
  [LIFImages, LIFMeta] = loadLIFFile(rawDataFolder);
  ySize = size(LIFImages{1}{1,1}, 1);
  xSize = size(LIFImages{1}{1,1}, 2);
  MovieTIFs = cell(1, 3);
  MaxTIFs = cell(1, 3);
  % loop through each series
  for seriesIndex = 1:size(LIFImages, 1)
      NumSlices = size(LIFImages{seriesIndex,1}, 1);
      TIFstack = zeros(ySize, xSize,NumSlices, 'uint16');
      for imageIndex = 1:NumSlices
          
          TIFstack(:,:,imageIndex) = LIFImages{seriesIndex,1}{imageIndex,1};
          
      end
      MovieTIFs{seriesIndex} = TIFstack;
      MaxTIFs{seriesIndex} = max(TIFstack,[], 3);
      MeanValues(i, seriesIndex) = mean(MaxTIFs{seriesIndex} , 'all');
  end
  AllTIFs{i} = MovieTIFs;
  AllMaxTIFs{i} = MaxTIFs;
      
end

MeanFluos = [MeanValues(:,1).' MeanValues(:,2).' MeanValues(:,3).' ];
MeanTemperatures = [Temperatures Temperatures Temperatures];
MeanDilutions = [Dilutions Dilutions Dilutions];
MeanPowers = [Powers Powers Powers];
%%
fits = {};
for dilution_level = [1000 2000]
    for power_level = [25 35 50]
        fits{end+1} = fitlm(MeanTemperatures(MeanDilutions == dilution_level & MeanPowers == power_level), MeanFluos(MeanDilutions == dilution_level & MeanPowers == power_level))
    end
end
%%







